{"version":3,"sources":["components/routing/HeaderMenu.js","components/explore/dashboardData/useDomainInfo.js","apis/db.js","images/background.jpeg","components/routing/Welcome.js","components/routing/AuthRoute.js","images/logo.png","components/home/CardTemplate.js","components/home/GatherCard.js","images/googleTakeout1.gif","images/googleTakeout2.gif","util/tokenize.js","actions/index.js","components/gather/GatherGoogleTakeout.js","components/home/GatherCardColumn.js","components/home/ExploreCard.js","components/home/ExploreCardColumn.js","components/home/DataSquare.js","components/explore/dashboards/dashboardParts/ColoredBackgroundGrid.js","components/explore/dashboards/dashboardParts/ConfirmDeleteModal.js","components/explore/dashboards/dashboardParts/DataTable.js","components/explore/dashboards/dashboardParts/QueryInput.js","util/intersect.js","components/explore/dashboardData/DashboardData.js","components/explore/dashboardData/useDashboardData.js","components/explore/dashboards/DashboardTemplate.js","components/explore/dashboards/dashboardParts/KeyCloud.js","components/explore/dashboards/dashboardParts/BubbleChart.js","components/explore/dashboards/dashboardParts/BubbleChartSpec.js","components/explore/BrowsingHistory.js","components/explore/YoutubeHistory.js","components/explore/SearchHistory.js","App.js","reducers/index.js","index.js"],"names":["withRouter","items","children","location","useLocation","menuItems","map","item","index","Menu","Item","as","Link","to","path","header","disabled","active","pathname","label","Sidebar","Pushable","inverted","animation","visible","direction","size","Pusher","updateDomainInfo","domains","a","db","getDomainInfo","cache","domainsToFetch","filter","domain","retry","length","fetchData","data","console","log","Object","keys","logo","toDataURL","dataUrl","addDomainInfo","entries","key","value","generateToken","token","body","urls","fetch","method","headers","JSON","stringify","response","json","empty","reduce","obj","message","concat","join","msgBuffer","TextEncoder","encode","crypto","subtle","digest","hashBuffer","hashArray","Array","from","Uint8Array","b","toString","padStart","url","callback","xhr","XMLHttpRequest","onload","reader","FileReader","onloadend","result","readAsDataURL","open","responseType","send","this","idb","Dexie","version","stores","meta","dataStatus","domainInfo","delete","isWelcome","add","welcome","get","name","fields","deleted","d","i","put","f","_INDEX","where","equals","modify","source","idFields","getData","fulldata","newDomains","existing","id","push","updateDataStatus","datastatus","current","date","Date","status","anyOf","toArray","table","row","info","bulkPut","then","catch","BulkError","e","Welcome","history","useHistory","beWelcomed","checkWelcome","useEffect","Grid","textAlign","style","height","backgroundImage","background","backgroundSize","verticalAlign","Column","maxWidth","Segment","border","Header","align","Button","primary","onClick","AuthRoute","Component","componentProps","useState","loading","setLoading","hasdb","setHasdb","connect","render","props","process","CardTemplate","subname","icon","done","Card","centered","cursor","width","marginLeft","marginRight","position","Dimmer","Loader","Icon","color","top","left","Content","float","content","replace","Meta","Description","statusMessage","produced","List","GatherCard","produces","statuses","useSelector","state","p","find","s","STOPWORDS_LOOKUP","sw","tokenize","text","split","toLowerCase","setDataStatus","type","dispatch","getState","newDataStatus","findIndex","WriteToDB","setOpen","useDispatch","ref","useRef","onChangeHandler","failed","newZip","JSZip","fileblob","target","files","loadAsync","zipped","file","async","chrome","parse","writeChromeHistory","youtube","parseYoutubeHtml","writeYoutubeHistory","click","hidden","onChange","accept","string","nodes","DOMParser","parseFromString","querySelector","querySelectorAll","node","aList","subtitles","textContent","attributes","href","titleUrl","title","br","datestring","nextSibling","time","toISOString","queries","URL","hostname","query","trim","words","word","convertTimestamp","time_usec","browser","page_transition","addData","channel","channel_url","Math","round","GatherGoogleTakeout","Modal","onClose","onOpen","trigger","rel","stackable","Container","ordered","marginTop","marginBottom","padding","src","gt1","alt","gt2","Actions","GoogleTakeout","GatherCardColumn","oldTime","currentTime","onDate","slice","ExploreCard","Browsing","Search","Youtube","ExploreCardColumn","headerStyle","fontSize","paddingBottom","paddingTop","columnStyle","cardGroupStyle","DeleteDataButton","button","margin","Popup","on","negative","fluid","destroyEverything","window","reload","DataSquare","ds","divided","Row","Group","ColoredBackgroundGrid","zIndex","bottom","right","overflow","ConfirmDeleteModal","dashData","deleteIds","setDeleteIds","ask","setAsk","handleDelete","rmID","n","backgroundColor","ButtonGroup","Checkbox","React","memo","DataTable","columns","selection","setN","setData","selectionN","setSelectionN","N","listData","onBottomVisible","paddingLeft","Visibility","continuous","ScrollingTable","Table","unstackable","fixed","singleLine","cells","column","HeaderCell","createHeader","rows","processContent","Cell","Body","createBody","QueryInput","searchOn","setSelection","search","setSearch","searching","setSearching","timer","setTimeout","clearTimeout","display","class","flex","Input","compact","anyDone","arrays","cursors","allEqual","allMax","max","intersect","array","fill","res","DashboardData","indices","setDeleted","triggerUpdate","isArray","regexes","q","RegExp","searchIn","field_loop","field","regex","test","values","_DELETED","value_loop","filterFunction","counts","list","createDashData","DashboardTemplate","dataName","VisComponent","calcStatistics","useDashboardData","statistics","setStatistics","altSelection","setAltSelection","querySelection","setQuerySelection","inSelection","setOutSelection","Statistics","borderRadius","statistic","BackButton","wordcloudOptions","rotations","enableOptimizations","enableTooltip","deterministic","fontFamily","fontSizes","transitionDuration","colors","KeyCloud","nWords","Set","setKeys","setWords","count","countsArray","sort","ignore","searchValues","getSelection","callbacks","useCallback","onWordClick","old","newkeys","has","getWordColor","boxShadow","minWidth","minSize","undefined","options","toUpperCase","fontStyle","Dropdown","multiple","clearable","minHeight","BubbleChart","createClassFromSpec","spec","$schema","autosize","resize","transform","expr","parentKey","signal","signals","events","update","force","scales","range","scheme","marks","enter","shape","scale","tooltip","x","y","stroke","strokeWidth","hover","tree","selectedDatum","setDomains","useDomainInfo","createTreeData","categories","category","parent","FIELD","SEARCHON","COLUMNS","stats","App","basename","exact","rootReducer","combineReducers","action","store","createStore","applyMiddleware","thunk","ReactDOM","StrictMode","document"],"mappings":"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","file":"static/js/main.84e3c460.chunk.js","sourcesContent":["import React from \"react\";\nimport { Menu, Sidebar } from \"semantic-ui-react\";\nimport { Link, withRouter, useLocation } from \"react-router-dom\";\n\nconst HeaderMenu = ({ items, children }) => {\n  // This header menu is super sneaky.\n  // It's actually not meant to be seen.\n  // But it's nice to be able to turn it on (set visible to true) when developing\n  // (and it now handles the routing)\n\n  const location = useLocation();\n\n  const menuItems = items.map((item, index) => {\n    return (\n      <Menu.Item\n        key={\"item-\" + index}\n        index={index}\n        as={Link}\n        to={item.path}\n        header={index === 0}\n        disabled={false}\n        active={item.path === location.pathname}\n      >\n        {item.label}\n      </Menu.Item>\n    );\n  });\n\n  return (\n    <Sidebar.Pushable>\n      <Sidebar as={Menu} inverted animation=\"push\" visible={false} direction={\"top\"} size=\"mini\">\n        {menuItems}\n      </Sidebar>\n      <Sidebar.Pusher>{children}</Sidebar.Pusher>\n    </Sidebar.Pushable>\n  );\n};\n\nexport default withRouter(HeaderMenu);\n","import db from \"apis/db\";\nimport { useState, useEffect } from \"react\";\n\n/**\n * Get domain info for given dashData instance.\n * assumes dashData.data.columns exists\n * @param {*} dashData\n * @returns\n */\nexport default function useDomainInfo(dashData) {\n  const [data, setData] = useState([]);\n  const [domains, setDomains] = useState(null);\n\n  useEffect(() => {\n    if (!dashData?.data) return;\n    const domains = {};\n    for (let d of dashData.data) if (d?.domain && !domains[d.domain]) domains[d.domain] = true;\n    setDomains(Object.keys(domains));\n  }, [dashData?.data]);\n\n  useEffect(() => {\n    if (!domains || domains.length === 0) return;\n    const fetchData = async () => {\n      const data = await updateDomainInfo(domains);\n      setData(data);\n    };\n\n    fetchData();\n  }, [domains]);\n\n  return data;\n}\n\nexport const updateDomainInfo = async (domains) => {\n  let cache = await db.getDomainInfo(domains);\n\n  // Check which domains are in the cache\n  const domainsToFetch = domains.filter((domain) => !cache[domain] || !cache[domain].retry);\n\n  if (domainsToFetch.length === 0) {\n    return cache;\n  }\n\n  // Create empty entries in cache to prevent refetching if domain is not available in service\n  for (let domain of domainsToFetch) cache[domain] = {};\n\n  const data = await fetchData(domainsToFetch);\n\n  // Get images\n  console.log(\"---------------------\");\n  const domain = Object.keys(data)[0];\n  const logo = data?.[domain]?.logo ? data[domain].logo : `http://${domain}/favicon.ico`;\n\n  const url = \"http://9gag.com\";\n  const googlefav = `https://t1.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${url}&size=128`;\n\n  toDataURL(googlefav, function (dataUrl) {\n    console.log(\"RESULT:\", dataUrl);\n  });\n\n  console.log(logo);\n\n  // Store results and return results including cached\n  db.addDomainInfo(data);\n\n  for (const [key, value] of Object.entries(data)) {\n    cache[key] = value;\n  }\n\n  return cache;\n};\n\nconst fetchData = async (domainsToFetch) => {\n  // try fetching data from amcat. If failed, return empty data with .retry = true to trigger\n  // retry on next call\n  try {\n    const token = await generateToken(\"1234\", domainsToFetch);\n    const body = {\n      token,\n      urls: domainsToFetch,\n    };\n\n    // Make request\n    const response = await fetch(\"https://dd.amcat.nl\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(body),\n    });\n    const data = await response.json();\n    return data;\n  } catch (e) {\n    const empty = domainsToFetch.reduce((obj, domain) => {\n      obj[domain] = { retry: true };\n      return obj;\n    }, {});\n    return empty;\n  }\n};\n\nconst generateToken = async (key, urls) => {\n  var message = [key].concat(urls).join(\"|\");\n  const msgBuffer = new TextEncoder().encode(message);\n  const hashBuffer = await crypto.subtle.digest(\"SHA-256\", msgBuffer);\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\n  return hashArray.map((b) => b.toString(16).padStart(2, \"0\")).join(\"\");\n};\n\nfunction toDataURL(url, callback) {\n  var xhr = new XMLHttpRequest();\n  xhr.onload = function () {\n    var reader = new FileReader();\n    reader.onloadend = function () {\n      callback(reader.result);\n    };\n    reader.readAsDataURL(xhr.response);\n  };\n  xhr.open(\"GET\", url);\n  xhr.responseType = \"blob\";\n  xhr.send();\n}\n","import { updateDomainInfo } from \"components/explore/dashboardData/useDomainInfo\";\nimport Dexie from \"dexie\";\n\n// Simplified alternative to previous use of indexedDB, motivated by:\n// - less dependencies\n// - avoiding dexie live hooks, which might not be supported on all devices\n// - we will now read full data (in a specific visualization) in memory anyway, so indexing is just a waste of time\n// - without indexing we can also encrypt entries. For instance linked to encryption keys in temporary cookies\n// - DB data type agnostic (not using different tables for types. components can figure that stuff out)\n\nclass FootprintDB {\n  constructor() {\n    // Dexie automatically checks whether a db with this name exists. If it does,\n    // it opens the existing one, if it doesn't, it creates a new one.\n    this.idb = new Dexie(\"FootprintDB\"); // idb = indexedDB\n\n    // the following 2 lines are only for developing\n    // if enabled (i.e. not commented), the db resets every time the app is started (also when refreshing)\n    // this.idb.delete();\n    // this.idb = new Dexie(\"FootprintDB\");\n\n    this.idb.version(2).stores({\n      meta: \"welcome\", // this just serves to keep track of whether db was 'created' via the welcome component. Eventually,\n      //  this would be a good place to add authentication / token validation\n      dataStatus: \"&name, source, status, date\",\n      data: \"&name, deleted\", // unindexed fields: \"data\". \"data\" is an array with all the data. \"deleted\" requires some explanation.\n      // data items can be deleted by users, but for speed we don't overwrite the data immediately,\n      // and instead store the indices values of the deleted items. The format is a boolean array of same length as data\n      domainInfo: \"&domain\", // unindexed: info\n    });\n  }\n\n  async destroyEverything() {\n    // reset database\n    await this.idb.delete();\n  }\n\n  // META\n  /** just serves to indicate that user has accepted conditions at welcome screen */\n  async welcome() {\n    if (!(await this.isWelcome())) this.idb.meta.add({ welcome: 1 });\n    return null;\n  }\n  async isWelcome() {\n    return this.idb.meta.get(1);\n  }\n\n  /////// DATA\n\n  async getData(name, fields) {\n    try {\n      let data = await this.idb.data.get({ name });\n      // For speed and efficiency, data items are not immediately deleted from the database when they are removed\n      // in the client but a lookup object for deleted indices is used (see note above in the IDB table declaration).\n      if (data?.deleted) {\n        data.data = data.data.filter((d, i) => !data.deleted[i]);\n        await this.idb.data.put({ name, deleted: null, data: data.data }, [name]);\n      }\n\n      if (fields) {\n        for (let i = 0; i < data.data.length; i++) {\n          const item = {};\n          for (let f of fields) item[f] = data.data[i][f];\n          data.data[i] = item;\n        }\n      }\n\n      for (let i = 0; i < data.data.length; i++) data.data[i]._INDEX = i;\n      return data.data;\n    } catch (e) {\n      return null;\n    }\n  }\n\n  async setDeleted(name, deleted) {\n    await this.idb.data.where(\"name\").equals(name).modify({ deleted });\n  }\n\n  // add data given name of data type (e.g., Browsing). idFields is an array of fields in data objects used to check for duplicates.\n  // e.g. ['url','date']\n  async addData(data, name, source, idFields = null) {\n    let fulldata = await this.getData(name);\n\n    const newDomains = {}; // also check for new domains, to immediately call backend for getting domaininfo\n    if (fulldata && fulldata.data.length > 0) {\n      const existing = {};\n      if (idFields) {\n        for (let d of data) {\n          if (d.domain && !newDomains[d.domain]) newDomains[d.domain] = true;\n          const id = JSON.stringify(idFields.map((f) => d[f]));\n          existing[id] = true;\n        }\n      }\n      for (let d of fulldata.data) {\n        if (d.domain && newDomains[d.domain]) newDomains[d.domain] = false;\n        if (idFields) {\n          const id = JSON.stringify(idFields.map((f) => d[f]));\n          if (existing[id]) continue;\n        }\n        data.push(d);\n      }\n    }\n\n    await this.idb.data.put({ name, deleted: null, data }, [name]);\n    await this.updateDataStatus(name, source);\n\n    const addDomainInfo = Object.keys(newDomains).filter((domain) => newDomains[domain]);\n    if (addDomainInfo.length > 0) updateDomainInfo(addDomainInfo);\n  }\n\n  /////// DATA STATUS\n\n  async getDataStatus(name) {\n    return this.idb.datastatus.get({ name });\n  }\n\n  async updateDataStatus(name, source) {\n    // note that status is always set to finished.\n    // whenever the datastatus table is updated, it its written to the dataStatus state (redux)\n    // This way the 'loading' status can be triggered via dispatch, and is set to finished when the update is finished\n    const current = await this.idb.dataStatus.get({ name });\n    const date = new Date();\n    if (current) {\n      this.idb.dataStatus.where(\"name\").equals(name).modify({ date, source, status: \"finished\" });\n    } else {\n      this.idb.dataStatus.add({ name, date, source, status: \"finished\" });\n    }\n  }\n\n  /////// DOMAIN INFO\n\n  async getDomainInfo(domains) {\n    // returns an object where keys are domains and values are info\n    const table = await this.idb.domainInfo.where(\"domain\").anyOf(domains).toArray();\n    return table.reduce((obj, row) => {\n      obj[row.url] = row.info;\n      return obj;\n    }, {});\n  }\n\n  async addDomainInfo(domainInfo) {\n    const data = Object.keys(domainInfo).map((key) => ({ domain: key, info: domainInfo[key] }));\n    this.idb.domainInfo\n      .bulkPut(data)\n      .then()\n      .catch(Dexie.BulkError, (e) => {\n        console.log(\"ignored some duplicates in writeDomainInfo\");\n      });\n  }\n}\n\nconst db = new FootprintDB();\nexport default db;\n","export default __webpack_public_path__ + \"static/media/background.eb5e36bf.jpeg\";","import React, { useEffect } from \"react\";\n\nimport db from \"apis/db\";\nimport { useHistory } from \"react-router-dom\";\nimport { Grid, Button, Header, Segment } from \"semantic-ui-react\";\nimport background from \"images/background.jpeg\";\n\n/**\n * This component only appears the first time users visit,\n * or if they are away so long that the indexedDB has been cleaned.\n * In time, this page should clearly list the terms and conditions.\n */\nconst Welcome = ({ items }) => {\n  const history = useHistory();\n\n  const beWelcomed = async (checkWelcome) => {\n    if (checkWelcome) {\n      const iswelcome = await db.isWelcome();\n      if (!iswelcome) return null;\n    }\n    try {\n      await db.welcome();\n      history.push(items[0].path);\n    } catch (e) {}\n  };\n\n  useEffect(() => {\n    beWelcomed(true);\n  });\n\n  return (\n    <Grid\n      inverted\n      textAlign=\"center\"\n      style={{\n        height: \"100vh\",\n        backgroundImage: `url(${background})`,\n        backgroundSize: \"100% 100%\",\n      }}\n      verticalAlign=\"middle\"\n    >\n      <Grid.Column style={{ maxWidth: 600 }}>\n        <Segment style={{ border: 0 }}>\n          <Header as=\"h2\">Welcome to the Digital Footprints Lab!</Header>\n          <p align=\"justified\">\n            This application let's you collect and explore your own digital traces. All the data is\n            stored and processed on your own device, and cannot be seen by anyone, so that you are\n            free to contemplate your life choices in solitude.\n          </p>\n          <p align=\"justified\">\n            We do, however, kindly ask you to anonymously donate some parts of this data for\n            scientific research. Specifically, we are interested in how you seek, consume and share\n            news articles. The data will be used for non-commercial research by a select group of\n            researchers at Dutch Universities.\n          </p>\n          <Button primary onClick={() => beWelcomed(false)}>\n            Great, let's get started!\n          </Button>\n        </Segment>\n      </Grid.Column>\n    </Grid>\n  );\n};\n\nexport default Welcome;\n","import React, { useState } from \"react\";\nimport { Route, Redirect } from \"react-router\";\nimport db from \"apis/db\";\n\n/**\n * Handles authentication (which at the moment is just accepting the welcome message)\n * Redirects to the welcome pages if the condition in connect is not met.\n */\nconst AuthRoute = ({ Component, ...componentProps }) => {\n  const [loading, setLoading] = useState(true);\n  const [hasdb, setHasdb] = useState(false);\n  // the weird trick for passing on componentProps is basically\n  // redundant with Redux, but leaving it intact just in case\n\n  const connect = async () => {\n    if (await db.isWelcome()) {\n      setHasdb(true);\n    } else {\n      setHasdb(false);\n    }\n    setLoading(false);\n  };\n\n  connect();\n\n  return (\n    <Route\n      {...componentProps}\n      render={(props) =>\n        loading ? (\n          <div>loading...</div>\n        ) : hasdb ? (\n          <Component {...componentProps} {...props} />\n        ) : (\n          <Redirect to={`${process.env.PUBLIC_URL}/`} />\n        )\n      }\n    />\n  );\n};\n\nexport default AuthRoute;\n","export default __webpack_public_path__ + \"static/media/logo.fc0d5b24.png\";","import React from \"react\";\nimport { Card, Dimmer, Icon, Loader } from \"semantic-ui-react\";\n\nconst CardTemplate = ({ children, name, subname, icon, onClick, loading, done }) => {\n  return (\n    <Card\n      centered\n      style={{\n        cursor: \"pointer\",\n        width: \"100%\",\n        marginLeft: \"2em\",\n        marginRight: \"2em\",\n        background: \"#ffffff00\",\n        position: \"relative\",\n      }}\n      onClick={onClick}\n    >\n      <Dimmer active={loading === \"loading\"}>\n        <Loader />\n      </Dimmer>\n      {done ? (\n        <Icon\n          size=\"massive\"\n          name=\"checkmark\"\n          style={{\n            position: \"absolute\",\n            color: \"#57b92d8c\",\n            top: \"20%\",\n            left: \"60%\",\n          }}\n        />\n      ) : null}\n      <Card.Content style={{ background: \"#ffffff\" }}>\n        <Icon size=\"huge\" name={icon} style={{ float: \"left\" }} />\n        <Card.Header content={name.replace(\"_\", \" \")} />\n        <Card.Meta content={subname} />\n\n        <Card.Description>{children}</Card.Description>\n      </Card.Content>\n    </Card>\n  );\n};\n\nexport default CardTemplate;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { List } from \"semantic-ui-react\";\nimport CardTemplate from \"./CardTemplate\";\nimport { useSelector } from \"react-redux\";\n\nconst propTypes = {\n  /** The name of the source from which to gather the data */\n  source: PropTypes.string.isRequired,\n  /** A subname, for extra info */\n  subname: PropTypes.string.isRequired,\n  /** An array of data names (e.g., Browsing history) that is expected to be produced */\n  produces: PropTypes.array.isRequired,\n  /** The name of an Icon from semantic ui, see https://semantic-ui.com/elements/icon.html  */\n  icon: PropTypes.string.isRequired,\n  /** Event handler for clicks. Not strictly necessary, because the card can also be used as a trigger (as in GatherGoogleTakeout) */\n  onClick: PropTypes.func,\n  /** String indicating loading status */\n  loading: PropTypes.string.isRequired,\n};\n\n/**\n * The template for generating GatherCards.\n * These are the cards in the Gather column on the home page.\n */\nconst GatherCard = ({ source, subname, produces, icon, onClick, loading }) => {\n  const statuses = useSelector((state) => {\n    return state.dataStatus.filter((data) => data.source === source);\n  });\n  let done = true;\n  const produced = produces.map((p) => {\n    const status = statuses.find((s) => s.name === p);\n    if (!status) done = false;\n    return status ? status : { name: p, status: \"empty\" };\n  });\n\n  return (\n    <CardTemplate\n      name={source}\n      subname={subname}\n      icon={icon}\n      onClick={onClick}\n      loading={loading}\n      done={done}\n    >\n      <List style={{ textAlign: \"left\" }}>{produced.map(statusMessage)}</List>\n    </CardTemplate>\n  );\n};\n\nconst statusMessage = (produced) => {\n  const name = produced.name.replace(\"_\", \" \");\n  if (produced.status === \"failed\")\n    return (\n      <List.Item>\n        <List.Icon name=\"close\" color=\"red\" />\n        <List.Content>\n          Failed to get <b>{name}</b>\n        </List.Content>\n      </List.Item>\n    );\n  if (produced.status === \"finished\")\n    return (\n      <List.Item>\n        <List.Icon name=\"check circle outline\" color=\"green\" />\n        <List.Content>\n          Gathered <b>{name}</b>\n        </List.Content>\n      </List.Item>\n    );\n\n  return (\n    <List.Item>\n      <List.Icon name=\"circle outline\" />\n      <List.Content>\n        Click to gather <b>{name}</b>\n      </List.Content>\n    </List.Item>\n  );\n};\n\nGatherCard.propTypes = propTypes;\nexport default GatherCard;\n","export default __webpack_public_path__ + \"static/media/googleTakeout1.d43cb755.gif\";","export default __webpack_public_path__ + \"static/media/googleTakeout2.97152dfa.gif\";","const STOPWORDS = [\"and\", \"or\", \"not\", \"the\", \"it\"]; // etc\nconst STOPWORDS_LOOKUP = STOPWORDS.reduce((obj, sw) => {\n  obj[sw] = true;\n  return obj;\n}, {});\n\n/**\n * Quick and dirty word tokenization, with very basic stopword filtering\n * Probably should replace this with a proper lightweight NLP package\n * @param {string} text The text to tokenize\n * @returns An array of the (filtered) tokens\n */\nconst tokenize = (text) => {\n  return text.split(/\\W+/).filter((token) => {\n    token = token.toLowerCase();\n    if (token.length <= 1) return false; // also drop single chars and empty\n    if (STOPWORDS_LOOKUP[token]) return false;\n    return true;\n  });\n};\n\nexport default tokenize;\n","export const setDataStatus = (dataStatus) => {\n  return {\n    type: \"SET_DATA_STATUS\",\n    dataStatus,\n  };\n};\n\nexport const updateDataStatus = (name, source, status) => {\n  const date = status === \"finished\" ? new Date() : null;\n\n  return (dispatch, getState) => {\n    const { dataStatus } = getState();\n    const newDataStatus = [...dataStatus];\n    const i = newDataStatus.findIndex((data) => data.name === name && data.source === source);\n    if (i < 0) {\n      newDataStatus.push({ name, source, date, status: status });\n    } else {\n      newDataStatus[i] = { ...newDataStatus[i], status: status };\n      if (date) newDataStatus[i].date = date;\n    }\n    dispatch(setDataStatus(newDataStatus));\n  };\n};\n","import React, { useRef, useState } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { Button, Container, Grid, Header, List, Modal, Segment } from \"semantic-ui-react\";\nimport gt1 from \"images/googleTakeout1.gif\";\nimport gt2 from \"images/googleTakeout2.gif\";\nimport db from \"apis/db\";\nimport tokenize from \"util/tokenize\";\n\nimport JSZip from \"jszip\";\nimport { useDispatch } from \"react-redux\";\nimport { updateDataStatus } from \"actions\";\n\n// This script handles everything related to importing Google_Takeout data\n// It should serve as an example for implementing other platforms\n// (and could probably do with a makeover)\n\nconst propTypes = {\n  /** A <GatherCard/>, which then serves as the trigger for the modal when clicked on */\n  children: PropTypes.element,\n  /** callback function for setting the loading status */\n  setLoading: PropTypes.func,\n};\n\n/**\n * The modal that opens when the Google_Takeout Gather card is clicked.\n */\nconst GatherGoogleTakeout = ({ children, setLoading }) => {\n  const [open, setOpen] = useState(false);\n\n  return (\n    <Modal\n      onClose={() => setOpen(false)}\n      onOpen={() => setOpen(true)}\n      open={open}\n      trigger={children}\n    >\n      <Modal.Header>Google Takeout</Modal.Header>\n      <Modal.Content>\n        <Modal.Description>\n          <p>\n            As you can imagine, Google has a lot of data about many people, and probably about you\n            as well. A lesser known fact is that the data is still yours, and Google is legally\n            required to give you access to it. You can obtain this data via{\" \"}\n            <a href=\"https://takeout.google.com/\" target=\"_blank\" rel=\"noopener noreferrer\">\n              Google Takeout.\n            </a>{\" \"}\n          </p>\n          <br />\n\n          <Grid stackable>\n            <Grid.Column width={16}>\n              <Container>\n                <Header>How do I order takeout from Google?</Header>\n\n                <List ordered>\n                  <List.Item>\n                    First, open the{\" \"}\n                    <a href=\"https://takeout.google.com/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                      Google Takeout\n                    </a>{\" \"}\n                    website (the link opens in a new tab or window).\n                  </List.Item>\n                  <List.Item>\n                    Find the list under <b>Create a new export</b>. Unselect everything, and then\n                    only select <b>Chrome</b> and <b>Youtube</b>\n                  </List.Item>\n\n                  <List.Item>\n                    For Youtube we also filter out some content. Click on{\" \"}\n                    <b>All Youtube data included</b>, and make sure to select only <b>History</b>.\n                    Then click on <b>Multiple formats</b> and for <b>History</b> change <b>HTML</b>{\" \"}\n                    to <b>JSON</b>\n                  </List.Item>\n                  <Grid stackable style={{ marginTop: \"1em\", marginBottom: \"1em\" }}>\n                    <Grid.Column width={8}>\n                      <Header textAlign=\"center\">Step 2</Header>\n                      <Segment style={{ padding: 0 }}>\n                        <img width=\"100%\" src={gt1} alt=\"loading...\" />\n                      </Segment>\n                    </Grid.Column>\n                    <Grid.Column width={8}>\n                      <Header textAlign=\"center\">Step 3</Header>\n                      <Segment style={{ padding: 0 }}>\n                        <img width=\"100%\" src={gt2} alt=\"loading...\" />\n                      </Segment>\n                    </Grid.Column>\n                  </Grid>\n                  <List.Item>\n                    Finally, click <b>Next step</b>. Here you can click <b>Create export</b> (the\n                    default settings are good). If you followed the selection steps, this will only\n                    be a few megabytes, and Google will send you the download link in a few minutes.\n                    This link will give you a <b>zip</b> file, that you can upload here:\n                  </List.Item>\n                </List>\n                <br />\n                <WriteToDB setOpen={setOpen} setLoading={setLoading} />\n              </Container>\n            </Grid.Column>\n          </Grid>\n        </Modal.Description>\n      </Modal.Content>\n      <Modal.Actions>\n        <Button onClick={() => setOpen(false)}>Cancel</Button>\n      </Modal.Actions>\n    </Modal>\n  );\n};\n\nconst WriteToDB = ({ setOpen, setLoading }) => {\n  const dispatch = useDispatch();\n  const ref = useRef();\n\n  const onChangeHandler = async (e) => {\n    dispatch(updateDataStatus(\"Browsing\", \"Google_Takeout\", \"loading\"));\n    dispatch(updateDataStatus(\"Search\", \"Google_Takeout\", \"loading\"));\n    dispatch(updateDataStatus(\"Youtube\", \"Google_Takeout\", \"loading\"));\n\n    let failed = false;\n\n    try {\n      setLoading(\"loading\");\n      setOpen(false);\n      let newZip = new JSZip();\n      let fileblob = e.target.files[0];\n\n      const zipped = await newZip.loadAsync(fileblob);\n\n      try {\n        let chrome = await zipped.file(\"Takeout/Chrome/BrowserHistory.json\").async(\"text\");\n        chrome = JSON.parse(chrome);\n        await writeChromeHistory(chrome[\"Browser History\"]);\n        dispatch(updateDataStatus(\"Browsing\", \"Google_Takeout\", \"finished\"));\n        dispatch(updateDataStatus(\"Search\", \"Google_Takeout\", \"finished\"));\n      } catch (e) {\n        failed = true;\n        dispatch(updateDataStatus(\"Browsing\", \"Google_Takeout\", \"failed\"));\n        dispatch(updateDataStatus(\"Search\", \"Google_Takeout\", \"failed\"));\n      }\n\n      try {\n        let youtube;\n        const isJSON = zipped.file(\"Takeout/YouTube and YouTube Music/history/watch-history.json\");\n        if (isJSON) {\n          youtube = await zipped\n            .file(\"Takeout/YouTube and YouTube Music/history/watch-history.json\")\n            .async(\"text\");\n          youtube = JSON.parse(youtube);\n        } else {\n          youtube = await zipped\n            .file(\"Takeout/YouTube and YouTube Music/history/watch-history.html\")\n            .async(\"text\");\n          youtube = parseYoutubeHtml(youtube);\n        }\n        await writeYoutubeHistory(youtube);\n        dispatch(updateDataStatus(\"Youtube\", \"Google_Takeout\", \"finished\"));\n      } catch (e) {\n        console.log(e);\n        failed = true;\n        dispatch(updateDataStatus(\"Youtube\", \"Google_Takeout\", \"failed\"));\n      }\n    } catch (e) {\n      setLoading(\"failed\");\n    }\n\n    setLoading(failed ? \"failed\" : \"finished\");\n  };\n\n  return (\n    <div style={{ textAlign: \"center\" }}>\n      <Button primary onClick={() => ref.current.click()}>\n        Import Google_Takeout\n      </Button>\n      <input\n        ref={ref}\n        type=\"file\"\n        name=\"file\"\n        hidden\n        onChange={onChangeHandler}\n        accept=\"application/zip\"\n      />\n    </div>\n  );\n};\n\nconst parseYoutubeHtml = (string) => {\n  const doc = new DOMParser().parseFromString(string, \"text/html\");\n  const nodes = doc.querySelector(\".mdl-grid\").querySelectorAll(\".mdl-grid\");\n\n  const items = [];\n  for (let i = 0; i < nodes.length; i++) {\n    const node = nodes[i];\n    const aList = node.querySelectorAll(\"a\");\n\n    const item = {};\n    if (aList.length === 2) {\n      item.subtitles = { name: aList[1].textContent, url: aList[1].attributes.href.textContent };\n    }\n    item.titleUrl = aList[0].attributes.href.textContent;\n    item.title = aList[0].textContent;\n\n    const br = node.children[1].querySelectorAll(\"br\");\n    const datestring = br[br.length - 1].nextSibling.textContent;\n    const date = new Date(Date.parse(datestring.replace(\"CEST\", \"GMT+0200\")));\n    item.time = date.toISOString();\n    items.push(item);\n  }\n  return items;\n};\n\nconst writeChromeHistory = async (history) => {\n  let urls = [];\n  let queries = [];\n\n  for (let item of history) {\n    let url = new URL(item.url);\n    if (url.hostname + url.pathname === \"www.google.com/search\") {\n      const query = item.title.replace(\"- Google Search\", \"\").trim();\n      let words = tokenize(query);\n      queries.push({\n        query: query,\n        word: words,\n        date: convertTimestamp(item.time_usec),\n        browser: \"Chrome\",\n      });\n      continue;\n    }\n\n    urls.push({\n      url: item.url,\n      title: item.title,\n      domain: url.hostname,\n      browser: \"Chrome\",\n      date: convertTimestamp(item.time_usec),\n      page_transition: item.page_transition,\n    });\n  }\n\n  await db.addData(queries, \"Search\", \"Google_Takeout\", [\"url\", \"date\"]);\n  await db.addData(urls, \"Browsing\", \"Google_Takeout\", [\"query\", \"date\"]);\n};\n\nconst writeYoutubeHistory = async (history) => {\n  let d = history.map((item) => {\n    return {\n      url: item.titleUrl,\n      title: item.title,\n      date: new Date(item.time),\n      channel: item.subtitles ? item.subtitles.name : \"channel removed\",\n      channel_url: item.subtitles ? item.subtitles.url : \"channel removed\",\n    };\n  });\n\n  console.log(d);\n  await db.addData(d, \"Youtube\", \"Google_Takeout\", [\"url\", \"date\"]);\n};\n\nconst convertTimestamp = (time) => {\n  // seems to be in microseconds since epoch\n  return new Date(Math.round(time / 1000));\n};\n\nGatherGoogleTakeout.propTypes = propTypes;\nexport default GatherGoogleTakeout;\n","import React, { useState } from \"react\";\nimport GatherCard from \"./GatherCard\";\nimport GatherGoogleTakeout from \"components/gather/GatherGoogleTakeout\";\n\n// Like explorecards, this creates the gather cards\n// These are a bit more tricky because these create modals (instead of routing to a new page)\n// The gather components therefore take the GatherCard as a child (used to trigger the modal)\n// and a setLoading prop that reports the loading status of the gather script. (see GatherGoogleTakeout)\n\n/**\n * Returns all gather cards to be rendered on the home page.\n */\nconst GatherCardColumn = () => {\n  // Currently only uses google takeout, so it looks silly\n  return <GoogleTakeout />;\n};\n\n/**\n * Renders the gather card for Google Takeout\n */\nconst GoogleTakeout = () => {\n  const [loading, setLoading] = useState(\"idle\");\n\n  // yes, it looks weird that the GatherCard is a child of the GatherGoogleTakeout\n  // the reason is that GatherGoogleTakeout is a popup, and the GatherCard is the trigger\n  return (\n    <GatherGoogleTakeout setLoading={setLoading}>\n      <GatherCard\n        source={\"Google_Takeout\"}\n        subname={\"takeout.google.com\"}\n        produces={[\"Browsing\", \"Search\", \"Youtube\"]}\n        icon={\"google\"}\n        loading={loading}\n      />\n    </GatherGoogleTakeout>\n  );\n};\n\nexport default GatherCardColumn;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router\";\nimport CardTemplate from \"./CardTemplate\";\nimport { List } from \"semantic-ui-react\";\n\nconst propTypes = {\n  /** The name of the type of data to explore. */\n  name: PropTypes.string.isRequired,\n  /** A subname, for extra info */\n  subname: PropTypes.string.isRequired,\n  /** The name of an Icon from semantic ui, see https://semantic-ui.com/elements/icon.html  */\n  icon: PropTypes.string.isRequired,\n};\n\n/**\n * The template for generating ExploreCards.\n * These are the cards in the Explore column on the home page.\n */\nconst ExploreCard = ({ name, subname, icon }) => {\n  const history = useHistory();\n  const statuses = useSelector((state) => {\n    return state.dataStatus.filter((data) => data.name === name && data.status === \"finished\");\n  });\n\n  if (!statuses || statuses.length === 0) return null;\n  console.log(statuses);\n\n  const onClick = () => {\n    history.push(name);\n  };\n\n  return (\n    <CardTemplate name={name} subname={subname} icon={icon} onClick={onClick}>\n      <List>{statuses.map(statusMessage)}</List>\n    </CardTemplate>\n  );\n};\n\nconst statusMessage = (status) => {\n  const date = status.date;\n  if (!date) return \"Data not yet gathered\"; // this shouldn't happen (card should only be shown if data available)\n\n  const oldTime = date.toISOString();\n  const currentTime = new Date().toISOString();\n\n  // if different day, show day\n  const today = oldTime.slice(0, 10) === currentTime.slice(0, 10);\n  const onDate = today ? \"today\" : `on ${oldTime.slice(0, 10)}`;\n\n  return (\n    <List.Item>\n      <List.Content>\n        Gathered {onDate} from <b>{status.source.replace(\"_\", \" \")}</b>\n      </List.Content>\n    </List.Item>\n  );\n};\n\nExploreCard.propTypes = propTypes;\nexport default ExploreCard;\n","import React from \"react\";\n\nimport ExploreCard from \"./ExploreCard\";\n\n/**\n * Returns all explore cards to be rendered on the home page.\n */\nconst ExploreCardColumn = () => {\n  return (\n    <>\n      <Browsing />\n      <Search />\n      <Youtube />\n    </>\n  );\n};\n\nconst Browsing = () => {\n  return <ExploreCard name={\"Browsing\"} subname={\"What pages did you visit?\"} icon={\"history\"} />;\n};\n\nconst Search = () => {\n  return <ExploreCard name={\"Search\"} subname={\"What did you search for?\"} icon={\"search\"} />;\n};\n\nconst Youtube = () => {\n  return <ExploreCard name={\"Youtube\"} subname={\"Channels and videos\"} icon={\"youtube\"} />;\n};\n\nexport default ExploreCardColumn;\n","import React, { useEffect } from \"react\";\nimport { Card, Grid, Header, Icon, Button, Popup } from \"semantic-ui-react\";\nimport logo from \"images/logo.png\";\nimport db from \"apis/db\";\n\nimport GatherCardColumn from \"./GatherCardColumn\";\nimport ExploreCardColumn from \"./ExploreCardColumn\";\nimport { useDispatch } from \"react-redux\";\nimport { setDataStatus } from \"actions\";\n\nconst headerStyle = {\n  color: \"white\",\n  fontSize: \"20px\",\n  filter: \"none\",\n  background: \"#00000078\",\n  paddingBottom: \"0.3em\",\n  paddingTop: \"0.4em\",\n};\n\nconst columnStyle = {\n  marginBottom: \"1em\",\n};\n\nconst cardGroupStyle = {\n  marginTop: \"2em\",\n};\n\nconst DataSquare = () => {\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    // on startup, check statuses in db and write to redux\n    db.idb.dataStatus\n      .toArray()\n      .then((ds) => dispatch(setDataStatus(ds)))\n      .catch((e) => console.log(e));\n  }, [dispatch]);\n\n  return (\n    <div style={{ height: \"100vh\", backgroundImage: `url(${logo})`, backgroundSize: \"100% 100%\" }}>\n      <Grid stackable divided centered>\n        <Grid.Row style={{ height: \"60px\" }}>\n          <Grid.Column>\n            <DeleteDataButton />\n          </Grid.Column>\n        </Grid.Row>\n        <Grid.Row>\n          <Grid.Column textAlign=\"center\" width={5} style={columnStyle}>\n            <Header style={headerStyle}>\n              <Icon name=\"cloud download\" />\n              Gather\n            </Header>\n\n            <Card.Group style={cardGroupStyle}>\n              <GatherCardColumn />\n            </Card.Group>\n          </Grid.Column>\n          <Grid.Column textAlign=\"center\" width={5} style={columnStyle}>\n            <Header style={headerStyle}>\n              <Icon name=\"search\" />\n              Explore\n            </Header>\n\n            <Card.Group style={cardGroupStyle}>\n              <ExploreCardColumn />\n            </Card.Group>\n          </Grid.Column>\n          <Grid.Column textAlign=\"center\" width={5} style={columnStyle}>\n            <Header style={headerStyle}>\n              <Icon name=\"student\" />\n              Donate\n            </Header>\n          </Grid.Column>\n        </Grid.Row>\n      </Grid>\n    </div>\n  );\n};\n\nconst DeleteDataButton = () => {\n  const button = (\n    <Button\n      style={{\n        float: \"right\",\n        background: \"#00000000\",\n        margin: \"10px\",\n        color: \"white\",\n        border: \"1px solid white\",\n      }}\n    >\n      <Icon name=\"trash\" />\n      Delete all data\n    </Button>\n  );\n\n  return (\n    <Popup on=\"click\" trigger={button}>\n      <Popup.Header>Delete data from browser</Popup.Header>\n      <Popup.Content>\n        <p>Do you want to delete all the gathered data from the browser?</p>\n        <p>\n          Note that any data you downloaded will still be on your computer, so you might want to\n          delete that as well.\n        </p>\n      </Popup.Content>\n      <br />\n      <Button\n        negative\n        fluid\n        onClick={() => db.destroyEverything().then(() => window.location.reload())}\n      >\n        Delete data\n      </Button>\n    </Popup>\n  );\n};\n\nexport default DataSquare;\n","import React from \"react\";\nimport { Grid } from \"semantic-ui-react\";\n\n/**\n * Create a Grid with a background that has a color on top of it.\n * This can be used with a transparent color to for instance darken a background\n * (for deployment, probably better to eventually just use a darkened image)\n * @returns\n */\nconst ColoredBackgroundGrid = ({ children, background, color }) => {\n  // just wrap the children in this component, pass an image path to background and a string to color\n  return (\n    <>\n      <div\n        style={{\n          zIndex: 1,\n          top: 0,\n          bottom: 0,\n          right: 0,\n          left: 0,\n          background: color,\n          position: \"absolute\",\n        }}\n      />\n      <Grid\n        style={{\n          height: \"100vh\",\n          overflow: \"auto\",\n          backgroundSize: \"100% 100%\",\n\n          backgroundImage: `url(${background})`,\n        }}\n      >\n        <div style={{ zIndex: 2 }}>{children}</div>\n      </Grid>\n    </>\n  );\n};\n\nexport default ColoredBackgroundGrid;\n","import PropTypes from \"prop-types\";\nimport React, { useState } from \"react\";\nimport { Button, ButtonGroup, Checkbox, Modal } from \"semantic-ui-react\";\n\nconst propTypes = {\n  /** The name of the table in DB */\n  table: PropTypes.string,\n};\n\n// Use this modal by keeping a 'confirm' state as follows:\n//   const [deleteIds, setDeleteIds] = useState([])\n// Then add ConfirmDeleteModal to the return JSX, pass on deleteIds and setDeleteIds,\n// and set table ids to deleteIds to trigger the confirm delete modal\n\nconst ConfirmDeleteModal = ({ dashData, deleteIds, setDeleteIds }) => {\n  const [ask, setAsk] = useState(true);\n\n  const handleDelete = async () => {\n    await dashData.rmID(deleteIds);\n    setDeleteIds([]);\n  };\n\n  const n = deleteIds?.length || 0;\n  if (!ask && n === 1) handleDelete();\n\n  return (\n    <Modal style={{ backgroundColor: \"#00000054\" }} open={n > 0} onClose={() => setDeleteIds([])}>\n      <Modal.Header>Delete item{n === 1 ? \"\" : \"s\"}</Modal.Header>\n      <Modal.Content>\n        <p>Are you sure you want to delete {n === 1 ? \"this item\" : `${n} items`}?</p>\n\n        <br />\n        <Modal.Actions>\n          <ButtonGroup centered=\"true\">\n            <Button fluid primary onClick={() => setDeleteIds([])}>\n              Cancel\n            </Button>\n            <Button fluid color=\"red\" onClick={(e, d) => handleDelete()}>\n              Yes\n            </Button>\n          </ButtonGroup>\n          {n > 1 ? null : (\n            <Checkbox\n              style={{ float: \"right\" }}\n              onChange={(e, d) => setAsk(!d.value)}\n              label=\"Do not ask again. Next time, delete immediately when clicking the trash icon\"\n            />\n          )}\n        </Modal.Actions>\n      </Modal.Content>\n    </Modal>\n  );\n};\n\nConfirmDeleteModal.propTypes = propTypes;\nexport default React.memo(ConfirmDeleteModal);\n","import React, { useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Container, Button, Visibility, Header, Segment, Table } from \"semantic-ui-react\";\nimport ConfirmDeleteModal from \"./ConfirmDeleteModal\";\n\nconst PAGESIZE = 25;\n\nconst propTypes = {\n  /** The name of the table in DB */\n  table: PropTypes.string,\n  /** An array indicating what columns should be shown and how.\n   * Items can be simple strings with columns names, or objects of {name: 'column name': f: function, width: int }\n   * f and width are optional. f is a function with the row object as an argument and should return the value to display\n   * width is an integer between 1 and 16 for semantic style width hints */\n  columns: PropTypes.array,\n  /** An array with row IDs to filter on */\n  selection: PropTypes.array,\n  /** A string to indicate the loading status */\n  loading: PropTypes.bool,\n};\n\n/**\n * Creates a table for a given table in the indexedDB\n */\nconst DataTable = ({ dashData, columns, selection }) => {\n  const [n, setN] = useState(0);\n  const [data, setData] = useState([]);\n  const [selectionN, setSelectionN] = useState(0);\n  const [deleteIds, setDeleteIds] = useState([]);\n\n  useEffect(() => {\n    if (!dashData) {\n      setData([]);\n      return null;\n    }\n    setSelectionN(dashData.N(selection));\n    setData(dashData.listData(PAGESIZE, selection));\n    setN(dashData.N());\n  }, [dashData, selection]);\n\n  const onBottomVisible = async () => {\n    // infinite scroll\n    // <Visibility> checks whether bottom of (invisible) div is visible, and if so adds more data\n    setData(dashData.listData(data.length + PAGESIZE, selection));\n  };\n\n  return (\n    <Container\n      style={{\n        height: \"98%\",\n        width: \"98%\",\n        padding: \"0\",\n      }}\n    >\n      <Segment style={{ background: \"#00000000\", height: \"50px\", margin: \"0\" }}>\n        <Header textAlign=\"center\" as=\"h2\" style={{ color: \"white\" }}>\n          {selectionN === n ? null : (\n            <Button\n              onClick={() => setDeleteIds(selection)}\n              icon=\"trash alternate\"\n              style={{\n                color: \"#b23434bd\",\n                padding: \"0\",\n                background: \"#ffffff00\",\n              }}\n            />\n          )}\n          {selectionN === n ? n : `${selectionN} / ${n}`} items\n        </Header>\n      </Segment>\n      <Container\n        style={{\n          height: \"calc(100% - 50px)\",\n          width: \"100%\",\n          overflow: \"auto\",\n          paddingLeft: \"20px\",\n        }}\n      >\n        <Visibility continuous onBottomVisible={onBottomVisible}>\n          <ScrollingTable dashData={dashData} data={data} columns={columns} />\n        </Visibility>\n      </Container>\n\n      <ConfirmDeleteModal dashData={dashData} deleteIds={deleteIds} setDeleteIds={setDeleteIds} />\n    </Container>\n  );\n};\n\nconst ScrollingTable = ({ dashData, data, columns }) => {\n  const [deleteIds, setDeleteIds] = useState([]);\n\n  const createHeader = () => {\n    const columnsWithTrash = [{ name: \"delete\", width: 1 }, ...columns];\n    const cells = columnsWithTrash.map((column) => {\n      const name = typeof column === \"object\" ? column.name : column;\n      return (\n        <Table.HeaderCell\n          key={column}\n          width={column?.width}\n          style={{ top: \"0px\", position: \"sticky\", zIndex: \"2\" }}\n        >\n          {name}\n        </Table.HeaderCell>\n      );\n    });\n    return (\n      <Table.Header>\n        <Table.Row>{cells}</Table.Row>\n      </Table.Header>\n    );\n  };\n\n  const createBody = () => {\n    const rows = data.map((row, i) => {\n      const cells = columns.map((column) => {\n        const name = typeof column === \"object\" ? column.name : column;\n        const f = column?.f || null;\n        const content = processContent(row, name, f);\n        return (\n          <Table.Cell key={name + \"_\" + i} title={content}>\n            {content}\n          </Table.Cell>\n        );\n      });\n      return (\n        <Table.Row key={i}>\n          <Table.Cell key=\"0\">\n            <Button\n              style={{ padding: \"5px\", background: \"red\", color: \"black\" }}\n              onClick={() => setDeleteIds([row._INDEX])}\n              icon=\"trash alternate\"\n            />\n          </Table.Cell>\n          {cells}\n        </Table.Row>\n      );\n    });\n    return <Table.Body>{rows}</Table.Body>;\n  };\n\n  if (data === null || data.length === 0 || !columns) return null;\n\n  return (\n    <Table\n      unstackable\n      fixed\n      singleLine\n      style={{ width: \"100%\", color: \"white\", background: \"#00000099\" }}\n    >\n      {createHeader()}\n      {createBody()}\n      <ConfirmDeleteModal dashData={dashData} deleteIds={deleteIds} setDeleteIds={setDeleteIds} />\n    </Table>\n  );\n};\n\nconst processContent = (row, column, f) => {\n  let content;\n  if (f) {\n    content = f(row);\n  } else {\n    content = row[column];\n    if (content instanceof Date) content = content.toISOString().slice(0, 19).replace(/T/g, \" \");\n  }\n  return content;\n};\n\nDataTable.propTypes = propTypes;\nexport default React.memo(DataTable);\n","import React, { useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Button, Input, Icon } from \"semantic-ui-react\";\n\nconst propTypes = {\n  /** The name of the table */\n  table: PropTypes.string,\n  /** An array with names of the (text) columns in the table that should be used for the fulltext search */\n  searchOn: PropTypes.array,\n  /** A callback function for returning the row IDs that match the query */\n  setSelection: PropTypes.func,\n};\n\n/**\n * Create an input for full text search\n */\nconst QueryInput = ({ dashData, searchOn, setSelection }) => {\n  const [search, setSearch] = useState(\"\");\n  const [searching, setSearching] = useState(false);\n\n  useEffect(() => {\n    setSearching(true);\n    const timer = setTimeout(() => {\n      if (dashData && search) {\n        setSelection(dashData.search(search, searchOn));\n      } else {\n        setSelection(null);\n      }\n      setSearching(false);\n    }, 500);\n    return () => clearTimeout(timer);\n  }, [dashData, search, searchOn, setSearching, setSelection]);\n\n  return (\n    <div style={{ display: \"flex\", margin: \"0\" }}>\n      <div class=\"dimmable\" style={{ width: \"50px\" }}>\n        <Icon\n          size=\"big\"\n          name={searching ? \"compass\" : \"search\"}\n          loading={searching}\n          style={{ paddingTop: \"9px\", paddingLeft: \"13fpx\", color: \"white\" }}\n        />\n      </div>\n      <div style={{ flex: \"1 1 auto\" }}>\n        <Input\n          fluid\n          value={search}\n          icon={\n            <Button\n              compact\n              icon=\"window close\"\n              onClick={() => setSearch(\"\")}\n              size=\"huge\"\n              style={{ color: \"white\", height: \"1em\", background: \"#ffffff00\" }}\n            />\n          }\n          onChange={(e, d) => setSearch(d.value)}\n        ></Input>\n      </div>\n    </div>\n  );\n};\n\nQueryInput.propTypes = propTypes;\nexport default React.memo(QueryInput);\n","/**\n * Intersect ordered numbers across multiple arrays.\n * Used in this app to quickly intersect the table row ids from different filters (e.g., text query, date, key)\n *\n * @param {array} arrays an array of arrays, where each array has sorted (!!!) integers\n * @returns An array of integers\n */\nconst intersect = (arrays) => {\n  arrays = arrays.filter((array) => array !== null);\n  if (arrays.length === 0) return null;\n  if (arrays.length === 1) return arrays[0];\n\n  const cursors = new Array(arrays.length).fill(0);\n  const res = [];\n\n  while (!anyDone(arrays, cursors)) {\n    if (allEqual(arrays, cursors)) {\n      console.log(cursors[0]);\n      res.push(arrays[0][cursors[0]]);\n      for (let i = 0; i < cursors.length; i++) cursors[i]++;\n    }\n    const max = allMax(arrays, cursors);\n    for (let i = 0; i < cursors.length; i++) {\n      if (arrays[i][cursors[i]] < max) cursors[i]++;\n    }\n  }\n  return res;\n};\n\nconst anyDone = (arrays, cursors) => {\n  for (let i = 0; i < arrays.length; i++) {\n    if (arrays[i].length <= cursors[i]) return true;\n  }\n  return false;\n};\n\nconst allEqual = (arrays, cursors) => {\n  for (let i = 1; i < arrays.length; i++) {\n    if (arrays[i][cursors[i]] !== arrays[0][cursors[0]]) return false;\n  }\n  console.log(\"-------------\");\n  for (let i = 0; i < arrays.length; i++) {\n    console.log(arrays[i][cursors[i]]);\n  }\n  return true;\n};\n\nconst allMax = (arrays, cursors) => {\n  let max = arrays[0][cursors[0]];\n  for (let i = 1; i < arrays.length; i++) {\n    if (arrays[i][cursors[i]] > max) max = arrays[i][cursors[i]];\n  }\n  return max;\n};\n\nexport default intersect;\n","import db from \"apis/db\";\n\n// move as much of the common data wrangling stuff here\n\nexport default class DashboardData {\n  constructor(name, data, setData, deleted = null) {\n    this.name = name;\n    this.data = data;\n    this.setData = setData;\n    this.deleted = deleted ? deleted : new Array(data.length).fill(false);\n  }\n\n  triggerUpdate() {\n    // need to deep copy class to trigger state update, and just recreating it seems fastest\n    this.setData(new DashboardData(this.name, this.data, this.setData, this.deleted));\n  }\n\n  async rmID(indices) {\n    // remove data by index. Note that data has a ._INDEX field to be certain the right indices are used\n    const deleted = [...this.deleted];\n    console.log(indices);\n    for (let i of indices) deleted[i] = true;\n    try {\n      await db.setDeleted(this.name, deleted);\n      this.deleted = deleted; // only update locally if DB write succeeded\n      this.triggerUpdate();\n    } catch (e) {\n      console.log(\"could not delete data\");\n    }\n  }\n\n  search(query, fields = null) {\n    // query can be a single query (string) or array.\n    // fields can be specific fields to search in, otherwise use all.\n    if (query === null || query.length === 0) return null;\n\n    const selection = [];\n\n    const queries = Array.isArray(query) ? query : [query];\n    const regexes = [];\n    for (let q of queries) regexes.push(new RegExp(q.replace(/[-/\\\\^$*+?.()|[\\]{}]/, \"\\\\$&\"), \"i\"));\n\n    for (let i = 0; i < this.data.length; i++) {\n      if (this.deleted[i]) continue;\n      const searchIn = fields ? fields : Object.keys(this.data[i]);\n      field_loop: for (let field of searchIn) {\n        for (let regex of regexes) {\n          if (regex.test(this.data[i][field])) {\n            selection.push(i);\n            break field_loop;\n          }\n        }\n      }\n    }\n    return selection;\n  }\n\n  searchValues(values, field) {\n    if (values === null || values.length === 0) return null;\n\n    const selection = [];\n    for (let i = 0; i < this.data.length; i++) {\n      if (this.data[i]._DELETED) continue;\n      value_loop: for (let value of values) {\n        if (Array.isArray(this.data[i][field])) {\n          for (let datavalue of this.data[i][field]) {\n            if (datavalue === value) {\n              selection.push(i);\n              break value_loop;\n            }\n          }\n        } else {\n          if (value === this.data[i][field]) {\n            selection.push(i);\n            break;\n          }\n        }\n      }\n    }\n    return selection;\n  }\n\n  findIndices(filterFunction) {\n    // argument is a function. Takes data item as argument and should return bool\n    const selection = [];\n    for (let i = 0; i < this.data.length; i++) {\n      if (this.deleted[i]) continue;\n      if (filterFunction(this.data[i])) selection.push(i);\n    }\n    return selection;\n  }\n\n  count(field, selection) {\n    // count unique values in field, return as {[value]: n, [value]: n}\n    let counts = {};\n\n    let index;\n    for (let i = 0; i < this.data.length; i++) {\n      if (selection) {\n        if (i >= selection.length) break;\n        index = selection[i];\n      } else index = i;\n\n      if (this.deleted[index]) continue;\n      let values = this.data[index][field];\n      if (!Array.isArray(values)) values = [values];\n      for (let value of values) {\n        if (value === \"\") continue;\n        if (!counts[value]) counts[value] = 0;\n        counts[value]++;\n      }\n    }\n    return counts;\n  }\n\n  N(selection) {\n    let n = 0;\n    let index;\n    for (let i = 0; i < this.data.length; i++) {\n      if (selection) {\n        if (i >= selection.length) break;\n        index = selection[i];\n      } else index = i;\n\n      if (this.deleted[index]) continue;\n      n++;\n    }\n    return n;\n  }\n\n  listData(n, selection) {\n    let list = [];\n    let index;\n    for (let i = 0; i < this.data.length; i++) {\n      if (list.length === n) break;\n      if (selection) {\n        if (i >= selection.length) break;\n        index = selection[i];\n      } else index = i;\n\n      if (this.deleted[index]) continue;\n      list.push(this.data[index]);\n    }\n    return list;\n  }\n}\n","import { useEffect, useState } from \"react\";\nimport db from \"apis/db\";\nimport DashboardData from \"./DashboardData\";\n\n/**\n * Get a dataset as a DashboardData class, with methods for searching, counting and filtering the data.\n *\n * @param {*} name     Name in db.data\n * @param {*} fields   An array with fieldnames from data to use\n * @returns\n */\nexport default function useDashboardData(name, fields) {\n  const [data, setData] = useState(null);\n\n  useEffect(() => {\n    createDashData(name, fields, setData);\n  }, [name, fields]);\n\n  return data;\n}\n\nconst createDashData = async (name, fields, setData) => {\n  try {\n    let data = await db.getData(name, fields);\n    const dashData = new DashboardData(name, data, setData); // with setData, dashboard can trigger its own state update\n    setData(dashData);\n  } catch (e) {\n    console.log(e);\n    setData(null);\n  }\n};\n","import React, { useEffect, useState } from \"react\";\nimport { Grid, Icon, Button, Container, Header, Item } from \"semantic-ui-react\";\n\nimport { useHistory } from \"react-router\";\n\nimport ColoredBackgroundGrid from \"./dashboardParts/ColoredBackgroundGrid\";\nimport background from \"images/background.jpeg\";\n\nimport DataTable from \"./dashboardParts/DataTable\";\nimport QueryInput from \"./dashboardParts/QueryInput\";\nimport intersect from \"util/intersect\";\nimport useDashboardData from \"../dashboardData/useDashboardData\";\nimport PropTypes from \"prop-types\";\n\nconst propTypes = {\n  /** The name of the type of data to explore. */\n  dataName: PropTypes.string.isRequired,\n  /** an Array indicating which fields in table should be used in the fulltext search */\n  searchOn: PropTypes.array.isRequired,\n  /** an array that conveys which fields in the table are shown in the DataTable. See DataTable for details */\n  columns: PropTypes.array.isRequired,\n  /** A react component that produces a visualization. Gets the properties dashData, inSelection and setOutSelection */\n  VisComponent: PropTypes.func.isRequired,\n  /** A function to produce the statistics. Gets arguments dashData and selection, and needs to return an array of objects\n   *  with keys 'label' and 'value'.\n   */\n  calcStatistics: PropTypes.func.isRequired,\n};\n\n/**\n * Re-usable component for making a dashboard. See e.g., BrowsingHistory.js for an example of how to use\n */\nconst DashboardTemplate = ({ dataName, searchOn, columns, VisComponent, calcStatistics }) => {\n  const dashData = useDashboardData(dataName);\n  const [statistics, setStatistics] = useState([]);\n  const [altSelection, setAltSelection] = useState(null);\n  const [querySelection, setQuerySelection] = useState(null);\n  const [selection, setSelection] = useState(null);\n\n  useEffect(() => {\n    setSelection(intersect([querySelection, altSelection]));\n  }, [querySelection, altSelection]);\n\n  useEffect(() => {\n    setStatistics(calcStatistics(dashData, selection));\n  }, [dashData, selection, calcStatistics]);\n\n  return (\n    <ColoredBackgroundGrid background={background} color={\"#000000b0\"}>\n      <Grid stackable>\n        <Grid.Row style={{}}>\n          <Grid.Column width={4}>\n            <BackButton />\n            <Container\n              style={{\n                margin: \"50px\",\n                marginTop: \"100px\",\n                padding: \"20px\",\n              }}\n            >\n              <div style={{ marginBottom: \"1em\" }}>\n                <QueryInput\n                  dashData={dashData}\n                  searchOn={searchOn}\n                  setSelection={setQuerySelection}\n                />\n              </div>\n\n              <Statistics statistics={statistics} />\n            </Container>\n          </Grid.Column>\n          <Grid.Column width={12}>\n            <VisComponent\n              dashData={dashData}\n              inSelection={querySelection}\n              setOutSelection={setAltSelection}\n            />\n          </Grid.Column>\n        </Grid.Row>\n        <Grid.Row style={{ height: \"500px\", width: \"100%\" }}>\n          <DataTable dashData={dashData} columns={columns} selection={selection} />\n        </Grid.Row>\n      </Grid>\n    </ColoredBackgroundGrid>\n  );\n};\n\nconst Statistics = ({ statistics }) => {\n  // statistics should be an array of objects, with: \"label\" and \"value\" keys.\n\n  return (\n    <Container\n      style={{\n        height: \"98%\",\n        padding: \"20px\",\n        background: \"#55555587\",\n        borderRadius: \"10px\",\n      }}\n    >\n      <Header as=\"h1\" align={\"center\"} style={{ color: \"white\", padding: \"0\", margin: \"0\" }}>\n        Statistics\n      </Header>\n      <Item.Group>\n        {statistics.map((statistic) => {\n          return (\n            <Item key={statistic.label}>\n              <Item.Content>\n                <Item.Header style={{ color: \"white\" }}>{statistic.label}</Item.Header>\n                <Item.Description style={{ color: \"white\" }}>{statistic.value}</Item.Description>\n              </Item.Content>\n            </Item>\n          );\n        })}\n      </Item.Group>\n    </Container>\n  );\n};\n\nconst BackButton = () => {\n  const history = useHistory();\n\n  return (\n    <Button\n      style={{\n        position: \"absolute\",\n        left: \"0\",\n        background: \"#00000000\",\n        color: \"white\",\n        border: \"1px solid white\",\n        marginLeft: \"20px\",\n        marginTop: \"20px\",\n      }}\n      onClick={() => history.push(\"/datasquare\")}\n    >\n      <Icon name=\"backward\" />\n      Go back\n    </Button>\n  );\n};\n\nDashboardTemplate.propTypes = propTypes;\nexport default React.memo(DashboardTemplate);\n","import React, { useEffect, useState } from \"react\";\nimport { PropTypes } from \"prop-types\";\nimport ReactWordcloud from \"react-wordcloud\";\n\nimport { Dimmer, Dropdown, Grid, Header, Loader } from \"semantic-ui-react\";\n\nconst wordcloudOptions = {\n  rotations: 0,\n  enableOptimizations: true,\n  enableTooltip: false,\n  deterministic: true,\n  fontFamily: \"impact\",\n  fontSizes: [20, 60],\n  transitionDuration: 500,\n  colors: [\"white\"],\n};\nconst wordcloudSize = undefined;\n\nconst propTypes = {\n  /** The name of the table in db */\n  table: PropTypes.string,\n  /** The name of the field in db */\n  field: PropTypes.string,\n  /** An array with a selection of row ids in table */\n  inSelection: PropTypes.array,\n  /** An integer specifying the number of words in the cloud*/\n  nWords: PropTypes.number,\n  /** A boolean for whether data is loading */\n  loading: PropTypes.bool,\n  /** A callback for setting the selection state */\n  setOutSelection: PropTypes.func,\n};\n\n/**\n * Makes a wordcloud for keys, for a given table:field in db\n */\nconst KeyCloud = ({ dashData, field, inSelection, nWords, setOutSelection }) => {\n  const [keys, setKeys] = useState(new Set([]));\n  const [words, setWords] = useState([]);\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (!dashData) {\n      setData(null);\n      setKeys(new Set([]));\n      return;\n    }\n    const counts = dashData.count(field, inSelection);\n    let countsArray = Object.keys(counts).map((key) => {\n      return { value: key, n: counts[key] };\n    });\n    countsArray.sort((a, b) => b.n - a.n); // sort from high to low value\n    setData(countsArray);\n    setKeys((keys) => new Set([...keys].filter((key) => counts[key] != null)));\n  }, [dashData, inSelection, field, setData, setLoading, setKeys]);\n\n  useEffect(() => {\n    if (!data) {\n      setWords([]);\n      return null;\n    }\n    const words = data.slice(0, nWords).map((word) => {\n      const text = word.value.replace(\"www.\", \"\");\n      return { text: text, key: word.value, value: word.n };\n    });\n    setWords(words);\n  }, [data, nWords]);\n\n  useEffect(() => {\n    let ignore = false;\n    const getSelection = async () => {\n      let selection = keys.size > 0 ? await dashData.searchValues([...keys], field) : null;\n      if (!ignore) setOutSelection(selection);\n    };\n    getSelection();\n    return () => {\n      ignore = true; // use closure to 'cancel' promise. prevents delayed older requests from overwriting new\n    };\n  }, [keys, setOutSelection, dashData, field]);\n\n  const callbacks = React.useCallback(() => {\n    return {\n      onWordClick: (word) => {\n        setKeys((old) => {\n          const newkeys = new Set([...old]);\n          if (newkeys.has(word.key)) {\n            newkeys.delete(word.key);\n          } else {\n            newkeys.add(word.key);\n          }\n          return newkeys;\n        });\n      },\n      getWordColor: (word) => {\n        if (keys.size === 0) return \"white\";\n        return keys.has(word.key) ? \"white\" : \"grey\";\n      },\n    };\n  }, [keys]);\n\n  return (\n    <Grid\n      style={{\n        height: \"100%\",\n        width: \"100%\",\n        background: \"#ffffff00\",\n        border: \"none\",\n        boxShadow: \"none\",\n        paddingTop: \"2em\",\n      }}\n    >\n      <Grid.Column width={12} style={{ padding: \"0\", margin: \"0\" }}>\n        <Dimmer active={loading}>\n          <Loader />\n        </Dimmer>\n        <Header as=\"h1\" align={\"center\"} style={{ color: \"white\", padding: \"0\", margin: \"0\" }}>\n          Top {nWords} {field}s\n        </Header>\n        <div style={{ overflow: \"auto\" }}>\n          <div style={{ height: \"400px\", minWidth: \"800px\" }}>\n            <ReactWordcloud\n              words={words}\n              minSize={wordcloudSize}\n              callbacks={callbacks()}\n              options={wordcloudOptions}\n            />\n          </div>\n        </div>\n      </Grid.Column>\n      <Grid.Column width={4}>\n        <Header style={{ color: \"white\" }}>{field.toUpperCase()} FILTER</Header>\n        <p style={{ fontStyle: \"italic\", color: \"white\" }}>\n          Filter on {field} by adding them below or clicking on the wordcloud\n        </p>\n        <Dropdown\n          fluid\n          multiple\n          selection\n          clearable\n          search\n          style={{\n            width: \"100%\",\n            color: \"white\",\n            minHeight: \"22em\",\n            background: \"#ffffff21\",\n          }}\n          value={[...keys]}\n          onChange={(e, d) => setKeys(new Set(d.value))}\n          options={\n            data\n              ? data.map((e) => ({\n                  value: e.value,\n                  text: e.value.replace(\"www.\", \"\"),\n                  key: e.value,\n                }))\n              : []\n          }\n        />\n      </Grid.Column>\n    </Grid>\n  );\n};\n\nKeyCloud.propTypes = propTypes;\nexport default React.memo(KeyCloud);\n","import React, { useEffect, useState } from \"react\";\nimport BubbleChartSpec from \"./BubbleChartSpec\";\nimport ConfirmDeleteModal from \"./ConfirmDeleteModal\";\nimport { Card, Button, Image, Dimmer, Loader } from \"semantic-ui-react\";\nimport useDomainInfo from \"components/explore/dashboardData/useDomainInfo\";\n/**\n * Makes a wordcloud for keys, for a given table:field in db\n */\nconst BubbleChart = ({ dashData, field, inSelection, setOutSelection }) => {\n  const [data, setData] = useState({ tree: [] }); // input for vega visualization\n  const [selectedDatum, setSelectedDatum] = useState(null);\n  const [deleteIds, setDeleteIds] = useState([]);\n  const [filteredDatum, setFilteredDatum] = useState(null);\n\n  const domainInfo = useDomainInfo(dashData);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    setData(createTreeData(dashData, field, inSelection, domainInfo));\n  }, [dashData, field, domainInfo, inSelection, setLoading]);\n\n  // Vega signal handler\n  const onSelectedDatum = (signal, datum) => {\n    if (datum === null) {\n      // Clicking outside circles will reset filter\n      setFilteredDatum(null);\n      setSelectedDatum(null);\n    } else {\n      if (datum.type === field) {\n        setSelectedDatum(datum);\n      }\n    }\n  };\n\n  // Vega signal handler\n\n  // Popup button handler\n  const filterSelectedDatum = async () => {\n    let selection = await dashData.searchValues([selectedDatum.name], field);\n    setOutSelection(selection);\n    setSelectedDatum(null);\n  };\n\n  // Popup button handler\n  const deleteSelectedDatum = async () => {\n    let selection = await dashData.searchValues([selectedDatum.name], field);\n    console.log(selection);\n    setDeleteIds(selection);\n    setSelectedDatum(null);\n  };\n\n  const signalListeners = {\n    selectedDatum: onSelectedDatum,\n  };\n\n  const popupStyle = {\n    zIndex: 1,\n    position: \"absolute\",\n    left: selectedDatum ? selectedDatum.x : 0,\n    top: selectedDatum ? selectedDatum.y : 0,\n  };\n\n  return null;\n  return (\n    <div style={{ position: \"relative\" }}>\n      <Dimmer active={loading}>\n        <Loader />\n      </Dimmer>\n      <BubbleChartSpec data={data} signalListeners={signalListeners} actions={false} />\n      {selectedDatum && (\n        <div style={popupStyle}>\n          <Card>\n            <Card.Content>\n              {selectedDatum.logo && <Image floated=\"left\" size=\"mini\" src={selectedDatum.logo} />}\n              <Button\n                basic\n                floated=\"right\"\n                size=\"mini\"\n                icon=\"close\"\n                onClick={() => setSelectedDatum(null)}\n              />\n              <Card.Header>{selectedDatum.name}</Card.Header>\n              <Card.Meta>{`${selectedDatum.count} visits`}</Card.Meta>\n              <Card.Description>\n                <p>{selectedDatum.title && selectedDatum.title}</p>\n                <p>Category: {selectedDatum.category ? selectedDatum.category : \"unknown\"}</p>\n              </Card.Description>\n            </Card.Content>\n            <Card.Content extra>\n              <div className=\"ui two buttons\">\n                <Button basic color=\"blue\" onClick={filterSelectedDatum}>\n                  Select\n                </Button>\n                <Button basic color=\"red\" onClick={deleteSelectedDatum}>\n                  Delete\n                </Button>\n              </div>\n            </Card.Content>\n          </Card>\n        </div>\n      )}\n      <ConfirmDeleteModal dashData={dashData} deleteIds={deleteIds} setDeleteIds={setDeleteIds} />\n    </div>\n  );\n};\n\nconst createTreeData = (dashData, field, selection, domainInfo) => {\n  const domains = dashData.count(field, selection);\n  const nodes = [];\n  let categories = {};\n  for (let domain of Object.keys(domains)) {\n    const category = domainInfo?.[domain] || domain.slice(0, 2);\n    const logo = domainInfo?.[domain]?.logo\n      ? domainInfo[domain].logo\n      : `http://${domain}/favicon.ico`;\n\n    if (!categories[category])\n      categories[category] = {\n        type: \"category\",\n        name: category,\n        count: 0,\n        parent: \"root\",\n        category,\n      };\n    categories[category].count++;\n\n    nodes.push({\n      type: field,\n      name: domain,\n      parent: category,\n      count: domains[domain],\n      category,\n      logo,\n    });\n  }\n\n  categories = Object.values(categories);\n  return { tree: [{ name: \"root\", type: \"root\" }, ...categories, ...nodes] };\n};\n\nexport default React.memo(BubbleChart);\n","import { createClassFromSpec } from \"react-vega\";\n\nexport default createClassFromSpec({\n  spec: {\n    $schema: \"https://vega.github.io/schema/vega/v5.json\",\n    width: 500,\n    height: 500,\n    padding: 0,\n    autosize: {\n      type: \"no\",\n      resize: false,\n    },\n\n    data: [\n      {\n        name: \"tree\",\n        transform: [\n          {\n            type: \"filter\",\n            expr: \"if(selectedDatum === null, datum.name == selectedDatum.name, true)\",\n          },\n          {\n            type: \"stratify\",\n            key: \"name\",\n            parentKey: \"parent\",\n          },\n          {\n            type: \"pack\",\n            field: \"count\",\n            sort: { field: \"count\" },\n            size: [{ signal: \"width\" }, { signal: \"height\" }],\n          },\n\n          {\n            type: \"filter\",\n            expr: \"datum.type != 'root' && datum.type != 'category'\",\n          },\n        ],\n      },\n    ],\n\n    signals: [\n      {\n        name: \"selectedDatum\",\n        value: \"null\",\n        on: [{ events: \"click\", update: \"datum\", force: \"true\" }],\n      },\n    ],\n\n    scales: [\n      {\n        name: \"color\",\n        type: \"ordinal\",\n        domain: { data: \"tree\", field: \"category\" },\n        range: { scheme: \"category20\" },\n      },\n    ],\n\n    marks: [\n      {\n        type: \"symbol\",\n        from: { data: \"tree\" },\n        encode: {\n          enter: {\n            shape: { value: \"circle\" },\n            fill: { scale: \"color\", field: \"category\" },\n            tooltip: { signal: \"datum.name\" },\n          },\n          update: {\n            x: { field: \"x\" },\n            y: { field: \"y\" },\n            size: { signal: \"4 * datum.r * datum.r\" },\n            stroke: { value: \"white\" },\n            strokeWidth: { value: 0.8 },\n          },\n          hover: {\n            stroke: { value: \"white\" },\n            strokeWidth: { value: 2 },\n          },\n        },\n      },\n      {\n        type: \"image\",\n        name: \"images\",\n        from: { data: \"tree\" },\n        encode: {\n          enter: {\n            url: { signal: \"datum.r < 16 ? '' : datum.logo\" },\n            tooltip: { signal: \"datum.name\" },\n          },\n          update: {\n            x: { signal: \"datum.x - min(datum.r, 32) / 2\" },\n            y: { signal: \"datum.y - min(datum.r, 32) / 2\" },\n            width: { signal: \"min(datum.r, 32)\" },\n            height: { signal: \"min(datum.r, 32)\" },\n          },\n          hover: {\n            stroke: { value: \"red\" },\n            strokeWidth: { value: 2 },\n          },\n        },\n      },\n    ],\n  },\n});\n","import React from \"react\";\nimport DashboardTemplate from \"./dashboards/DashboardTemplate\";\nimport KeyCloud from \"./dashboards/dashboardParts/KeyCloud\";\nimport BubbleChart from \"./dashboards/dashboardParts/BubbleChart\";\n\nconst FIELD = \"domain\";\nconst SEARCHON = [\"url\", \"title\"];\nconst COLUMNS = [\"date\", \"title\", \"url\"];\n\n/**\n * A dashboard for the browsing history data.\n * Note that this component is reached via the react router.\n */\nexport default function BrowsingHistory() {\n  return (\n    <DashboardTemplate\n      dataName=\"Browsing\"\n      searchOn={SEARCHON}\n      columns={COLUMNS}\n      VisComponent={VisComponent}\n      calcStatistics={calcStatistics}\n    />\n  );\n}\n\nconst VisComponent = ({ dashData, inSelection, setOutSelection }) => {\n  if (!dashData) return null;\n  return (\n    <div style={{ width: \"20vw\", height: \"vh\" }}>\n      <BubbleChart\n        dashData={dashData}\n        field={FIELD}\n        inSelection={inSelection}\n        setOutSelection={setOutSelection}\n      />\n    </div>\n  );\n};\n\nconst VisComponent2 = ({ dashData, inSelection, setOutSelection }) => {\n  return (\n    <KeyCloud\n      dashData={dashData}\n      field={FIELD}\n      inSelection={inSelection}\n      nWords={50}\n      setOutSelection={setOutSelection}\n    />\n  );\n};\n\nconst calcStatistics = (dashData, selection) => {\n  if (!dashData) return [];\n  const counts = dashData.count(FIELD, selection);\n\n  const stats = {};\n  stats[\"Total visits\"] = 0;\n  stats[\"Most visited\"] = [\"none\", 0]; // array of [0] key and [1] count\n  stats[\"Unique websites\"] = 0;\n  for (let key of Object.keys(counts)) {\n    stats[\"Total visits\"] += counts[key];\n    stats[\"Unique websites\"]++;\n    if (counts[key] > stats[\"Most visited\"][1]) stats[\"Most visited\"] = [key, counts[key]];\n  }\n\n  return Object.keys(stats).map((label) => ({ label, value: stats[label] }));\n};\n","import React from \"react\";\nimport DashboardTemplate from \"./dashboards/DashboardTemplate\";\nimport KeyCloud from \"./dashboards/dashboardParts/KeyCloud\";\n\nconst FIELD = \"channel\";\nconst SEARCHON = [\"channel\", \"title\"];\nconst COLUMNS = [\"channel\", \"title\", \"date\"];\n\n/**\n * A dashboard for the browsing history data.\n * Note that this component is reached via the react router.\n * When the card on the home page is clicked, it navigates to /Browsing\n */\nexport default function Youtube() {\n  return (\n    <DashboardTemplate\n      dataName=\"Youtube\"\n      searchOn={SEARCHON}\n      columns={COLUMNS}\n      VisComponent={VisComponent}\n      calcStatistics={calcStatistics}\n    />\n  );\n}\n\nconst VisComponent = ({ dashData, inSelection, setOutSelection }) => {\n  return (\n    <KeyCloud\n      dashData={dashData}\n      field={FIELD}\n      inSelection={inSelection}\n      nWords={50}\n      setOutSelection={setOutSelection}\n    />\n  );\n};\n\nconst calcStatistics = (dashData, selection) => {\n  if (!dashData) return [];\n  const counts = dashData.count(FIELD, selection);\n\n  const stats = {};\n  stats[\"Total visits\"] = 0;\n  stats[\"Most visited\"] = [\"none\", 0]; // array of [0] key and [1] count\n  stats[\"Unique websites\"] = 0;\n  for (let key of Object.keys(counts)) {\n    stats[\"Total visits\"] += counts[key];\n    stats[\"Unique websites\"]++;\n    if (counts[key] > stats[\"Most visited\"][1]) stats[\"Most visited\"] = [key, counts[key]];\n  }\n\n  return Object.keys(stats).map((label) => ({ label, value: stats[label] }));\n};\n","import React from \"react\";\nimport DashboardTemplate from \"./dashboards/DashboardTemplate\";\nimport KeyCloud from \"./dashboards/dashboardParts/KeyCloud\";\n\nconst FIELD = \"word\";\nconst SEARCHON = [\"word\"];\nconst COLUMNS = [\"query\", \"date\"];\n\n/**\n * A dashboard for the browsing history data.\n */\nexport default function SearchHistory() {\n  return (\n    <DashboardTemplate\n      dataName=\"Search\"\n      searchOn={SEARCHON}\n      columns={COLUMNS}\n      VisComponent={VisComponent}\n      calcStatistics={calcStatistics}\n    />\n  );\n}\n\nconst VisComponent = ({ dashData, inSelection, setOutSelection }) => {\n  return (\n    <KeyCloud\n      dashData={dashData}\n      field={FIELD}\n      inSelection={inSelection}\n      nWords={50}\n      setOutSelection={setOutSelection}\n    />\n  );\n};\n\nconst calcStatistics = (dashData, selection) => {\n  if (!dashData) return [];\n  const counts = dashData.count(FIELD, selection);\n\n  const stats = {};\n  stats[\"Total visits\"] = 0;\n  stats[\"Most visited\"] = [\"none\", 0]; // array of [0] key and [1] count\n  stats[\"Unique websites\"] = 0;\n  for (let key of Object.keys(counts)) {\n    stats[\"Total visits\"] += counts[key];\n    stats[\"Unique websites\"]++;\n    if (counts[key] > stats[\"Most visited\"][1]) stats[\"Most visited\"] = [key, counts[key]];\n  }\n\n  return Object.keys(stats).map((label) => ({ label, value: stats[label] }));\n};\n","import React from \"react\";\nimport { BrowserRouter, Route, Switch } from \"react-router-dom\";\nimport HeaderMenu from \"./components/routing/HeaderMenu\";\nimport \"./App.css\";\n\n// login and authenticated route\nimport Welcome from \"./components/routing/Welcome\";\nimport AuthRoute from \"./components/routing/AuthRoute\";\n\n// Main pages. Use below in items to include in header menu\nimport DataSquare from \"./components/home/DataSquare\";\nimport BrowsingHistory from \"./components/explore/BrowsingHistory\";\nimport YoutubeHistory from \"./components/explore/YoutubeHistory\";\nimport SearchHistory from \"./components/explore/SearchHistory\";\n\n// Change to add new components to the header\n// The first item will be the opening page after login\nconst items = [\n  { label: \"Data square\", path: \"/datasquare\", Component: DataSquare },\n  { label: \"Browsing History\", path: \"/browsing\", Component: BrowsingHistory },\n  { label: \"Search\", path: \"/search\", Component: SearchHistory },\n  { label: \"Youtube\", path: \"/youtube\", Component: YoutubeHistory },\n];\n\nconst App = () => {\n  const createNavigation = (items) => {\n    return items.map((item) => {\n      return <AuthRoute key={item.path} path={item.path} Component={item.Component} />;\n    });\n  };\n\n  return (\n    <div style={{ background: \"#0C1D35\", height: \"100%\" }}>\n      <BrowserRouter basename={process.env.PUBLIC_URL}>\n        <HeaderMenu items={items}>\n          <Switch>\n            <Route exact path={\"/\"} render={() => <Welcome items={items} />} />\n            {createNavigation(items)}\n          </Switch>\n        </HeaderMenu>\n      </BrowserRouter>\n    </div>\n  );\n};\n\nexport default App;\n","import { combineReducers } from \"redux\";\n\nconst dataStatus = (state = [], action) => {\n  switch (action.type) {\n    case \"SET_DATA_STATUS\":\n      // set whole status array\n      return action.dataStatus;\n    default:\n      return state;\n  }\n};\n\nconst rootReducer = combineReducers({\n  dataStatus,\n});\n\nexport default rootReducer;\n","import \"semantic-ui-css/semantic.min.css\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport { createStore, applyMiddleware } from \"redux\";\nimport thunk from \"redux-thunk\";\nimport rootReducer from \"./reducers\";\nimport { Provider } from \"react-redux\";\n\nconst store = createStore(rootReducer, applyMiddleware(thunk));\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.querySelector(\"#root\")\n);\n"],"sourceRoot":""}