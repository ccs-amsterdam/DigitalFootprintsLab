import React, { useEffect } from "react";
import { useDispatch } from "react-redux";
import { setDataStatus } from "actions";
import db from "apis/db";
import ExploreCard from "./ExploreCard";

/**
 * Returns all explore cards to be rendered on the home page.
 */
const ExploreCardColumn = () => {
  const dispatch = useDispatch();

  // useLiveQuery monitors IndexedDb and sends updates to the redux store
  // this is used to display the status of the cards
  // useLiveQuery(async () => {
  //   const dataStatus = await db.idb.datastatus.toArray();
  //   dispatch(setDataStatus(dataStatus));
  // });

  useEffect(() => {
    db.idb.dataStatus
      .toArray()
      .then((ds) => dispatch(setDataStatus(ds)))
      .catch((e) => console.log(e));
  }, [dispatch]);

  return (
    <>
      <Browsing />
      <Search />
      <Youtube />
    </>
  );
};

const Browsing = () => {
  return (
    <ExploreCard
      name={"Browsing history"}
      subname={"What pages did you visit?"}
      icon={"history"}
      table={"browsinghistory"}
    />
  );
};

const Search = () => {
  return (
    <ExploreCard
      name={"Google searches"}
      subname={"What did you search for?"}
      icon={"search"}
      table={"searchhistory"}
    />
  );
};

const Youtube = () => {
  return (
    <ExploreCard
      name={"Youtube"}
      subname={"Channels and videos"}
      icon={"youtube"}
      table={"youtube"}
    />
  );
};

export default ExploreCardColumn;
